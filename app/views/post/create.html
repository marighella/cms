<form name="postForm" nonvalidate ng-init='load()' class='create'>
  <div class='form-group'
    ng-repeat="field in fields"
    ng-switch on="field.type.view">
    <label class='control-label' for='{{ field.name }}'
      ng-hide='field.type.view === "cover"'>
      <i class="fa {{ field.icon }}"></i>
      {{ field.title }}
    </label>

      <div class="form-inline datepicker" ng-switch-when="date">
        <div class="form-group">
          <input type="text" size="10" class="form-control"
          ng-model="entity[field.name]"
           data-date-format="dd/MM/yyyy"
          data-autoclose="1" placeholder="Date" data-max-date='today' bs-datepicker>
        </div>
        <div class="form-group">
          <input type="text" size="8" class="form-control"
          ng-model="entity[field.name]"
          data-autoclose="1" placeholder="Time" bs-timepicker>
        </div>
      </div>

      <div ng-switch-when="video" show-errors>
        <input type="text"
        dynamic-name="field.name"
        class="form-control"
        ng-model="entity[field.name]"
        placeholder="{{ field.placeholder }}"
        ng-pattern="{{ field.pattern }}"
        dynamic-required="field"
        />
        <youtube ng-show="entity[field.name]" url="{{ entity[field.name] }}"></youtube>
      </div>

      <div ng-switch-when="textarea" show-errors>
        <textarea type="text"
          dynamic-name="field.name"
          class="form-control"
          ng-model="entity[field.name]"
          ng-required="{{ field.required }}"
          placeholder="{{ field.placeholder }}"
          rows='1'
          expand>
        </textarea>
      </div>

      <div ng-switch-when="text" show-errors>
        <input type="text"
          dynamic-name="field.name"
          class="form-control"
          ng-model="entity[field.name]"
          ng-required="{{ field.required }}"
          placeholder="{{ field.placeholder }}"
          dynamic-required="field">
        </input>
      </div>

      <div ng-switch-when="select" show-errors>
        <select
          dynamic-name="field.name"
          ng-model="entity[field.name]"
          ng-options="item.id as item.name for item in field.type.options"
          dynamic-required="field"
          class="form-control">
          <option value="">-- Nenhum --</option>
        </select>
      </div>
      <div ng-switch-when="tagging" show-errors>
        <tags-input
          ng-model="entity[field.name]"
          dynamic-name="field.name"
          display-property="tag"
          class='tag-input'
          placeholder="{{ field.placeholder }}">
        </tags-input>
      </div>
  </div>
  <div class='form-group'>
    <textarea ck-editor ng-model="body">
    </textarea>
  </div>

  <div ng-include="'views/post/include/gallery.html'">
  </div>

  <div class='alert-cover' ng-show='!cover'>
    <label>Não se esqueça de colocar uma imagem como capa!</label>
    <input type='text' ng-model='cover' name='cover' required ng-hide='true'/>
  </div>

  <button class="btn btn-default btn-block draft" ng-disabled="true" ng-show="state != 'default'">
    <strong>Trabalhando...
      <i class="fa fa-cog fa-spin" ></i>
    </strong>
  </button>

  <div class="btn-group btn-block draft" ng-hide="state != 'default'">
    <button type="button" class="btn btn-default action" ng-click='save(postForm, action)'>
      Terminou? E agora nós vamos
      <span ng-show='!action || action === "nothing" '>...</span>
      <strong ng-show='action === "publish"'>Publicar!</strong>
      <strong ng-show='action === "draft"'>Salvar!</strong>
    </button>
    <button type="button" class="btn btn-default dropdown-toggle action-caret" data-toggle="dropdown">
      <span class="caret"></span>
      <span class="sr-only">Toggle Dropdown</span>
    </button>
    <ul class="dropdown-menu" role="menu">
      <li><a ng-click='action = "nothing"'>Ainda estou na duvida...</a></li>
      <li class="divider"></li>
      <li><a ng-click='action = "draft"'>Mandar para o <span class="label label-default">rascunho</span> e terminar depois</a></li>
      <li><a ng-click='action = "publish"'><span class="label label-primary">Publicar</span> e levar o conhecimento ao povo!</a></li>
    </ul>
  </div>


</form>
